{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nexports.__esModule = true;\nexports.generateRestHandlers = exports.withErrors = exports.getResponseStatusByErrorType = exports.createUrlBuilder = void 0;\n\nvar pluralize_1 = __importDefault(require(\"pluralize\"));\n\nvar msw_1 = require(\"msw\");\n\nvar OperationError_1 = require(\"../errors/OperationError\");\n\nfunction createUrlBuilder(baseUrl) {\n  return function (path) {\n    var url = new URL(path, baseUrl || 'http://localhost');\n    return baseUrl ? url.toString() : url.pathname;\n  };\n}\n\nexports.createUrlBuilder = createUrlBuilder;\n\nfunction getResponseStatusByErrorType(error) {\n  switch (error.type) {\n    case OperationError_1.OperationErrorType.EntityNotFound:\n      return 404;\n\n    case OperationError_1.OperationErrorType.DuplicatePrimaryKey:\n      return 409;\n\n    default:\n      return 500;\n  }\n}\n\nexports.getResponseStatusByErrorType = getResponseStatusByErrorType;\n\nfunction withErrors(handler) {\n  return function (req, res, ctx) {\n    try {\n      return handler(req, res, ctx);\n    } catch (error) {\n      return res(ctx.status(getResponseStatusByErrorType(error)), ctx.json({\n        message: error.message\n      }));\n    }\n  };\n}\n\nexports.withErrors = withErrors;\n\nfunction generateRestHandlers(modelName, primaryKey, model, baseUrl) {\n  if (baseUrl === void 0) {\n    baseUrl = '';\n  }\n\n  var modelPath = pluralize_1[\"default\"](modelName);\n  var buildUrl = createUrlBuilder(baseUrl);\n  return [msw_1.rest.get(buildUrl(modelPath), withErrors(function (req, res, ctx) {\n    var cursor = req.url.searchParams.get('cursor');\n    var rawSkip = req.url.searchParams.get('skip');\n    var rawTake = req.url.searchParams.get('take');\n    var skip = parseInt(rawSkip !== null && rawSkip !== void 0 ? rawSkip : '0', 10);\n    var take = rawTake == null ? rawTake : parseInt(rawTake, 10);\n    var options = {\n      where: {}\n    };\n\n    if (take && !isNaN(take) && !isNaN(skip)) {\n      options = Object.assign(options, {\n        take: take,\n        skip: skip\n      });\n    }\n\n    if (take && !isNaN(take) && cursor) {\n      options = Object.assign(options, {\n        take: take,\n        cursor: cursor\n      });\n    }\n\n    var records = model.findMany(options);\n    return res(ctx.json(records));\n  })), msw_1.rest.get(buildUrl(modelPath + \"/:\" + primaryKey), withErrors(function (req, res, ctx) {\n    var _a;\n\n    var id = req.params[primaryKey];\n    var where = (_a = {}, _a[primaryKey] = {\n      equals: id\n    }, _a);\n    var entity = model.findFirst({\n      strict: true,\n      where: where\n    });\n    return res(ctx.json(entity));\n  })), msw_1.rest.post(buildUrl(modelPath), withErrors(function (req, res, ctx) {\n    var createdEntity = model.create(req.body);\n    return res(ctx.status(201), ctx.json(createdEntity));\n  })), msw_1.rest.put(buildUrl(modelPath + \"/:\" + primaryKey), withErrors(function (req, res, ctx) {\n    var _a;\n\n    var id = req.params[primaryKey];\n    var where = (_a = {}, _a[primaryKey] = {\n      equals: id\n    }, _a);\n    var updatedEntity = model.update({\n      strict: true,\n      where: where,\n      data: req.body\n    });\n    return res(ctx.json(updatedEntity));\n  })), msw_1.rest[\"delete\"](buildUrl(modelPath + \"/:\" + primaryKey), withErrors(function (req, res, ctx) {\n    var _a;\n\n    var id = req.params[primaryKey];\n    var where = (_a = {}, _a[primaryKey] = {\n      equals: id\n    }, _a);\n    var deletedEntity = model[\"delete\"]({\n      strict: true,\n      where: where\n    });\n    return res(ctx.json(deletedEntity));\n  }))];\n}\n\nexports.generateRestHandlers = generateRestHandlers;","map":{"version":3,"sources":["/Users/daniel/Documents/GitHub/hr-study-buddy/node_modules/@mswjs/data/lib/model/generateRestHandlers.js"],"names":["__importDefault","mod","__esModule","exports","generateRestHandlers","withErrors","getResponseStatusByErrorType","createUrlBuilder","pluralize_1","require","msw_1","OperationError_1","baseUrl","path","url","URL","toString","pathname","error","type","OperationErrorType","EntityNotFound","DuplicatePrimaryKey","handler","req","res","ctx","status","json","message","modelName","primaryKey","model","modelPath","buildUrl","rest","get","cursor","searchParams","rawSkip","rawTake","skip","parseInt","take","options","where","isNaN","Object","assign","records","findMany","_a","id","params","equals","entity","findFirst","strict","post","createdEntity","create","body","put","updatedEntity","update","data","deletedEntity"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nexports.__esModule = true;\nexports.generateRestHandlers = exports.withErrors = exports.getResponseStatusByErrorType = exports.createUrlBuilder = void 0;\nvar pluralize_1 = __importDefault(require(\"pluralize\"));\nvar msw_1 = require(\"msw\");\nvar OperationError_1 = require(\"../errors/OperationError\");\nfunction createUrlBuilder(baseUrl) {\n    return function (path) {\n        var url = new URL(path, baseUrl || 'http://localhost');\n        return baseUrl ? url.toString() : url.pathname;\n    };\n}\nexports.createUrlBuilder = createUrlBuilder;\nfunction getResponseStatusByErrorType(error) {\n    switch (error.type) {\n        case OperationError_1.OperationErrorType.EntityNotFound:\n            return 404;\n        case OperationError_1.OperationErrorType.DuplicatePrimaryKey:\n            return 409;\n        default:\n            return 500;\n    }\n}\nexports.getResponseStatusByErrorType = getResponseStatusByErrorType;\nfunction withErrors(handler) {\n    return function (req, res, ctx) {\n        try {\n            return handler(req, res, ctx);\n        }\n        catch (error) {\n            return res(ctx.status(getResponseStatusByErrorType(error)), ctx.json({\n                message: error.message\n            }));\n        }\n    };\n}\nexports.withErrors = withErrors;\nfunction generateRestHandlers(modelName, primaryKey, model, baseUrl) {\n    if (baseUrl === void 0) { baseUrl = ''; }\n    var modelPath = pluralize_1[\"default\"](modelName);\n    var buildUrl = createUrlBuilder(baseUrl);\n    return [\n        msw_1.rest.get(buildUrl(modelPath), withErrors(function (req, res, ctx) {\n            var cursor = req.url.searchParams.get('cursor');\n            var rawSkip = req.url.searchParams.get('skip');\n            var rawTake = req.url.searchParams.get('take');\n            var skip = parseInt(rawSkip !== null && rawSkip !== void 0 ? rawSkip : '0', 10);\n            var take = rawTake == null ? rawTake : parseInt(rawTake, 10);\n            var options = { where: {} };\n            if (take && !isNaN(take) && !isNaN(skip)) {\n                options = Object.assign(options, { take: take, skip: skip });\n            }\n            if (take && !isNaN(take) && cursor) {\n                options = Object.assign(options, { take: take, cursor: cursor });\n            }\n            var records = model.findMany(options);\n            return res(ctx.json(records));\n        })),\n        msw_1.rest.get(buildUrl(modelPath + \"/:\" + primaryKey), withErrors(function (req, res, ctx) {\n            var _a;\n            var id = req.params[primaryKey];\n            var where = (_a = {},\n                _a[primaryKey] = {\n                    equals: id\n                },\n                _a);\n            var entity = model.findFirst({\n                strict: true,\n                where: where\n            });\n            return res(ctx.json(entity));\n        })),\n        msw_1.rest.post(buildUrl(modelPath), withErrors(function (req, res, ctx) {\n            var createdEntity = model.create(req.body);\n            return res(ctx.status(201), ctx.json(createdEntity));\n        })),\n        msw_1.rest.put(buildUrl(modelPath + \"/:\" + primaryKey), withErrors(function (req, res, ctx) {\n            var _a;\n            var id = req.params[primaryKey];\n            var where = (_a = {},\n                _a[primaryKey] = {\n                    equals: id\n                },\n                _a);\n            var updatedEntity = model.update({\n                strict: true,\n                where: where,\n                data: req.body\n            });\n            return res(ctx.json(updatedEntity));\n        })),\n        msw_1.rest[\"delete\"](buildUrl(modelPath + \"/:\" + primaryKey), withErrors(function (req, res, ctx) {\n            var _a;\n            var id = req.params[primaryKey];\n            var where = (_a = {},\n                _a[primaryKey] = {\n                    equals: id\n                },\n                _a);\n            var deletedEntity = model[\"delete\"]({\n                strict: true,\n                where: where\n            });\n            return res(ctx.json(deletedEntity));\n        })),\n    ];\n}\nexports.generateRestHandlers = generateRestHandlers;\n"]},"metadata":{},"sourceType":"script"}