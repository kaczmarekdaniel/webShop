{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/daniel/Documents/GitHub/hr-study-buddy/src/hooks/useAuth.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useError } from 'hooks/useError';\nconst AuthContext = /*#__PURE__*/React.createContext({});\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n\n  const [user, setUser] = useState(null);\n  const {\n    dispatchError\n  } = useError();\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      (async () => {\n        try {\n          const response = await axios.get('/me', {\n            headers: {\n              authorization: `Bearer ${token}`\n            }\n          });\n          setUser(response.data);\n        } catch (e) {\n          console.log(e);\n        }\n      })();\n    }\n  }, []);\n\n  const signIn = async ({\n    login,\n    password\n  }) => {\n    try {\n      const response = await axios.post('/login', {\n        login,\n        password\n      });\n      setUser(response.data);\n      localStorage.setItem('token', response.data.token);\n    } catch (e) {\n      dispatchError('Invalid email or password');\n    }\n  };\n\n  const signOut = () => {\n    setUser(null);\n    localStorage.removeItem('token');\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      signIn,\n      signOut\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 10\n  }, this);\n};\n\n_s(AuthProvider, \"yLxN5D1+9WDAnoFRKPM4BxB6sgw=\", false, function () {\n  return [useError];\n});\n\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n\n  const auth = useContext(AuthContext);\n\n  if (!auth) {\n    throw Error('useAuth needs to be used inside AuthContext');\n  }\n\n  return auth;\n};\n\n_s2(useAuth, \"2E+KaGHVlJMhtGjyKmHdHkA1EKU=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/Users/daniel/Documents/GitHub/hr-study-buddy/src/hooks/useAuth.js"],"names":["React","useContext","useEffect","useState","axios","useError","AuthContext","createContext","AuthProvider","children","user","setUser","dispatchError","token","localStorage","getItem","response","get","headers","authorization","data","e","console","log","signIn","login","password","post","setItem","signOut","removeItem","useAuth","auth","Error"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,UAAhB,EAA4BC,SAA5B,EAAuCC,QAAvC,QAAuD,OAAvD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,gBAAzB;AAEA,MAAMC,WAAW,gBAAGN,KAAK,CAACO,aAAN,CAAoB,EAApB,CAApB;AAEA,OAAO,MAAMC,YAAY,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAkB;AAAA;;AAC5C,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBR,QAAQ,CAAC,IAAD,CAAhC;AACA,QAAM;AAAES,IAAAA;AAAF,MAAoBP,QAAQ,EAAlC;AAEAH,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMW,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;;AACA,QAAIF,KAAJ,EAAW;AACT,OAAC,YAAY;AACX,YAAI;AACF,gBAAMG,QAAQ,GAAG,MAAMZ,KAAK,CAACa,GAAN,CAAU,KAAV,EAAiB;AACtCC,YAAAA,OAAO,EAAE;AACPC,cAAAA,aAAa,EAAG,UAASN,KAAM;AADxB;AAD6B,WAAjB,CAAvB;AAKAF,UAAAA,OAAO,CAACK,QAAQ,CAACI,IAAV,CAAP;AACD,SAPD,CAOE,OAAOC,CAAP,EAAU;AACVC,UAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACD;AACF,OAXD;AAYD;AACF,GAhBQ,EAgBN,EAhBM,CAAT;;AAkBA,QAAMG,MAAM,GAAG,OAAO;AAAEC,IAAAA,KAAF;AAASC,IAAAA;AAAT,GAAP,KAA+B;AAC5C,QAAI;AACF,YAAMV,QAAQ,GAAG,MAAMZ,KAAK,CAACuB,IAAN,CAAW,QAAX,EAAqB;AAC1CF,QAAAA,KAD0C;AAE1CC,QAAAA;AAF0C,OAArB,CAAvB;AAIAf,MAAAA,OAAO,CAACK,QAAQ,CAACI,IAAV,CAAP;AACAN,MAAAA,YAAY,CAACc,OAAb,CAAqB,OAArB,EAA8BZ,QAAQ,CAACI,IAAT,CAAcP,KAA5C;AACD,KAPD,CAOE,OAAOQ,CAAP,EAAU;AACVT,MAAAA,aAAa,CAAC,2BAAD,CAAb;AACD;AACF,GAXD;;AAaA,QAAMiB,OAAO,GAAG,MAAM;AACpBlB,IAAAA,OAAO,CAAC,IAAD,CAAP;AACAG,IAAAA,YAAY,CAACgB,UAAb,CAAwB,OAAxB;AACD,GAHD;;AAKA,sBAAO,QAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AAAEpB,MAAAA,IAAF;AAAQc,MAAAA,MAAR;AAAgBK,MAAAA;AAAhB,KAA7B;AAAA,cAAyDpB;AAAzD;AAAA;AAAA;AAAA;AAAA,UAAP;AACD,CAzCM;;GAAMD,Y;UAEeH,Q;;;KAFfG,Y;AA2Cb,OAAO,MAAMuB,OAAO,GAAG,MAAM;AAAA;;AAC3B,QAAMC,IAAI,GAAG/B,UAAU,CAACK,WAAD,CAAvB;;AAEA,MAAI,CAAC0B,IAAL,EAAW;AACT,UAAMC,KAAK,CAAC,6CAAD,CAAX;AACD;;AAED,SAAOD,IAAP;AACD,CARM;;IAAMD,O","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useError } from 'hooks/useError';\n\nconst AuthContext = React.createContext({});\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const { dispatchError } = useError();\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      (async () => {\n        try {\n          const response = await axios.get('/me', {\n            headers: {\n              authorization: `Bearer ${token}`,\n            },\n          });\n          setUser(response.data);\n        } catch (e) {\n          console.log(e);\n        }\n      })();\n    }\n  }, []);\n\n  const signIn = async ({ login, password }) => {\n    try {\n      const response = await axios.post('/login', {\n        login,\n        password,\n      });\n      setUser(response.data);\n      localStorage.setItem('token', response.data.token);\n    } catch (e) {\n      dispatchError('Invalid email or password');\n    }\n  };\n\n  const signOut = () => {\n    setUser(null);\n    localStorage.removeItem('token');\n  };\n\n  return <AuthContext.Provider value={{ user, signIn, signOut }}>{children}</AuthContext.Provider>;\n};\n\nexport const useAuth = () => {\n  const auth = useContext(AuthContext);\n\n  if (!auth) {\n    throw Error('useAuth needs to be used inside AuthContext');\n  }\n\n  return auth;\n};\n"]},"metadata":{},"sourceType":"module"}